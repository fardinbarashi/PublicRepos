# Fix-CVE-2021-34527

<!-- LICENSE -->
## License
Distributed under the GPL-3.0 License. See `LICENSE.txt` for more information.

# 🛡️ PsFix-CVE-2021-34527 – PowerShell Remediation Script
## 📄 Description
This script is designed as a **security mitigation** for the Windows Print Spooler vulnerability:  
**CVE-2021-34527**, also known as **PrintNightmare**.

It performs the following actions on remote servers:
- 🚫 Changes ACL permissions on the print driver folder to deny "System" modification access
- 🛑 Stops the `Spooler` service
- 🔒 Sets the Spooler service startup type to `Disabled`

---

## ⚙️ System Requirements
| Requirement             | Value                     |
|------------------------|---------------------------|
| PowerShell Version     | 5.1.19041.2364            |
| Remoting Enabled       | ✅ Required on all servers |
| Access Permissions     | Administrator             |

---

## 🧾 Script Info

| Property         | Value                                      |
|------------------|--------------------------------------------|
| **Author**       | Fardin Barashi (`Fardin.barashi@gmail.com`) |
| **Script Title** | PsFix-CVE-2021-34527                        |
| **Version**      | -                                          |
| **Release Date** | -                                          |
| **GitHub**       | [github.com/fardinbarashi](https://github.com/fardinbarashi) |

---

## 🖥️ What the Script Does

1. **Imports server names** from `Serverlist.csv`
2. For each server, it performs the following **remediation actions remotely**:
   - Locks down folder: `C:\Windows\System32\spool\drivers`
   - Denies modify access to `System`
   - Stops the Print Spooler service
   - Disables the Spooler from starting again

---

## 📂 File Structure

```
<root-folder>\
├── PsFix-CVE-2021-34527.ps1
├── Logs\
│   └── PsFix-CVE-2021-34527 - yyyy-MM-dd-HH.mm.ss.txt
├── Serverlist.csv
```

---

## 📝 Example of `Serverlist.csv`

```csv
ServerName
SERVER01
SERVER02
SERVER03
```

> Make sure PowerShell Remoting (WinRM) is enabled and accessible on the target servers.

---

## 📡 Usage

1. **Edit the `Serverlist.csv`** and enter your server names.
2. **Run the script as Administrator** from a machine that has access to all remote servers.

```powershell
.\PsFix-CVE-2021-34527.ps1
```

---

## 📌 Notes

- 📁 ACL changes apply only to `C:\Windows\System32\spool\drivers`
- ⚠️ Be cautious: This action will **disable printing** capabilities on the target servers
- 🔐 Logs are saved under `/Logs` for auditing purposes

---

## 🧑‍💻 Maintainer

- **Name:** Fardin Barashi  
- **Email:** Fardin.barashi@gmail.com  
- **GitHub:** [github.com/fardinbarashi](https://github.com/fardinbarashi)

---












